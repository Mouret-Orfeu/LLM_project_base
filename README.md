
# LLM Project Base

## Description

A simple Hugging Face (HF) language model fine-tuning project adaptable for any HF model, on any Q&A dataset. The example run and analysis uses a dataset of IT ticket descriptions and resolutions.
Parts of the project are inspired by or adapted from Andrej Karpathy's minGPT: https://github.com/karpathy/minGPT.

## Project Structure

All the code is in the src folder. Inside, the custom package llm_custom_lib includes:

- `Evaluator.py` Simple custom evaluation utility that allows you to evaluate a model on a dataset using the `eval_split` method.
- `Trainer.py` Simple custom training loop, boilerplate that could apply to any arbitrary neural network.
- `HFModelAdapter.py` Encapsulation class for Hugging Face models to be trained with the Trainer class.
- `CustomDataset.py` Inherits from `torch.utils.data.Dataset`, deals with data sampling for the torch loader. Also deals with prompt formatting, padding, and loss mask for the model prediction.
- `utils.py` Simple utilities, mostly for configuration management and logging.

In the src folder, there are 4 other files, among which 3 are notebooks:

- `data_analysis.ipynb`: Example of exploratory dataset analysis.
- `model_training_and_evaluation_demo.ipynb`: Simple model training and evaluation pipeline in notebook cells, using the custom package llm_custom_lib.
- `result_analysis.ipynb`: Example exploration of the performance metric dataset generated by `full_model_train_and_eval_script.py` and the loss curves.

The final file is `full_model_train_and_eval_script.py`, a Python script that generates and saves a dataframe of evaluation metrics as well as training logs for some basic combinations of hyperparameters (such as training duration in number of epochs (or rather number of batches), model type if several are tested or dataset split).


### Setup

If you want to run this project locally, you have to run (preferably in a virtual environment):

```
python -m pip install --upgrade pip
pip install -r requirements.txt
pip install -e .
```
